extends layout

block content
    div(align='center')
      h1 Survey Creator 
      h3 Please add emails of people you want to invite to this survey.
      h3 Survey ID: #{getsurveyid}
    div(align='center', ng-app='ng-app')
      hr
      textarea#emails(rows='10', cols='50', name='emails')
      br
      button.btn.btn-medium.btn-success(type='submit', ng-model='yourButton', name='emailsubmit', onclick='addemailaddress()') Add emails to list
      hr
      form#addusertosurvey(method='post', action='/adduserstosurvey')
        br
        input(type='hidden', name='surveyid', value= getsurveyid)
        input(type='hidden', name='startdate', value= getstartdate)
        div#emailsform
          div#endemailsform
        br
        hr
        button.btn.btn-medium.btn-info(type="submit" form="addusertosurvey" value="addemails") Add emails to survey
        br
        br
        a.btn.btn-medium.btn-info(href="/creator")= "Back"
        br
        br
        //input(type='submit', ng-model='yourSubmit', name='submit', value='Add emails to survey')
    script(type='text/javascript').
      function addemailaddress(){
          var allinput = "";
          var input = "";
          var regexmail = /^\w+[\w-\.]*\@\w+((-\w+)|(\w*))\.[a-z]{2,3}$/;
          var emails = document.getElementById("emails").value;
          var res = emails.split(/[-;,' '\n]/);
          for(var i = 0; i< res.length;i++){
              if(res[i].match(regexmail)){
                  input = '<input type="checkbox" name="email" value='+res[i]+' checked>'+res[i]+'<br>';
                  allinput = allinput + input;
              }
          }
          var newtype = document.createElement("div");
          //newtype.setAttribute("id", answerno);
          newtype.innerHTML = allinput;
          var div = document.getElementById("emailsform");
          var enddiv = document.getElementById("endemailsform");
          div.insertBefore(newtype, enddiv); 
      }
